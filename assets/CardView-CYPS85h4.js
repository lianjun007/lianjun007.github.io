import{_ as I,b as t,c as s,r as h,o as M,a as W,d as L,l as O,m as S,j as D,e as n,g as i,t as a,F as w,h as E}from"./index-BD61sLrq.js";import{a as z,g as V}from"./function-aY7JZtoC.js";const H={name:"SvgIcon",props:{src:{type:String,required:!0},color:{type:String,default:"var(--themeColor)"}},data(){return{svgContent:""}},watch:{src:"loadSvg",color:"updateSvgColor"},mounted(){this.loadSvg()},methods:{async loadSvg(){try{const m=await fetch(this.src);if(!m.ok)throw new Error(`Failed to fetch SVG: ${m.statusText}`);const r=await m.text();this.svgContent=r,this.updateSvgColor()}catch(m){console.error("Failed to load SVG:",m),this.svgContent="<svg><text x='10' y='20'>SVG Error</text></svg>"}},updateSvgColor(){if(!this.svgContent)return;const l=new DOMParser().parseFromString(this.svgContent,"image/svg+xml").querySelector("svg");l&&(l.querySelectorAll("[fill]").forEach(e=>{e.setAttribute("fill",this.color)}),l.querySelectorAll("[stroke]").forEach(e=>{e.setAttribute("stroke",this.color)}),this.svgContent=l.outerHTML)}}},q=["innerHTML"];function j(m,r,l,e,v,y){return t(),s("div",{innerHTML:v.svgContent,class:"svgIcon"},null,8,q)}const Ge=I(H,[["render",j]]),B={name:"Waterfall",props:{columnCount:{type:Number,default:2}},setup(m){const r=h(null);let l=null,e=null,v=0;const y=()=>{const f=r.value;if(!f)return;const k=Array.from(f.children),x=f.offsetWidth,_=x<240?1:Math.min(Math.floor(x/220),m.columnCount),u=new Array(_).fill(0),C=(x-(_-1)*10)/_;k.forEach(o=>{const c=o.offsetHeight,g=u.indexOf(Math.min(...u));o.style.width=`${C}px`,o.style.top=`${u[g]+10}px`,o.style.left=`${g*C+g*10}px`,u[g]+=c+10}),f.style.height=`${Math.max(...u)}px`},d=()=>{e=setInterval(()=>{y()},300)},b=()=>{e&&(clearInterval(e),e=null)},T=()=>{const f=r.value;if(!f)return;const k=f.offsetWidth;k!==v&&(y(),v=k)};return M(()=>{l=new ResizeObserver(T),r.value&&l.observe(r.value),d()}),W(()=>{l&&l.disconnect(),b()}),{waterfallContainer:r}}},G={id:"waterfall",class:"cardModule",ref:"waterfallContainer"};function P(m,r,l,e,v,y){return t(),s("div",G,[L(m.$slots,"default",{},void 0)],512)}const Pe=I(B,[["render",P],["__scopeId","data-v-a253e045"]]),U={name:"CardView",props:{item:{type:Object,required:!0}},setup(m){const r=h(m.item),l=h(null),e=h(0),v=h(0),y=h(0),d=h(!0);let b;const T=()=>{if(l.value){const o=l.value.getBoundingClientRect().width;e.value=Math.min(o/7>30?o/7:20,70),v.value=Math.min(o/3,120),y.value=Math.min(o/13>20?o/13:20,30);const c=300;d.value=o>=c}},f=h(0),k=h(0);r.value.sub&&r.value.sub.forEach(o=>{o.sub?k.value++:f.value++}),fetch("./json/tagTheme.json").then(o=>o.json()).then(o=>{Array.from(document.getElementsByClassName("tag")).forEach(c=>{const g=c.textContent.trim(),p=getComputedStyle(c).getPropertyValue("--subThemeColor");o[g]?(c.style.backgroundColor=o[g],c.style.color=z(o[g])):(c.style.backgroundColor=p,c.style.color=z(p))})});const x=O(()=>V(m.item.path)),_=h(null),u=()=>{if(!_.value)return;const o=_.value,c=o.scrollLeft,g=o.scrollWidth-o.clientWidth,p=20,A=c<=0,R=c>=g,N=A?0:p,F=R?100:100-p;o.style.mask=`
            linear-gradient(
                90deg,
                transparent 0,
                #fff ${N}%,
                #fff ${F}%,
                transparent 100%
            )
            `},C=()=>{if(!_.value)return;let o;const c=_.value,g=()=>{window.cancelAnimationFrame(o),o=window.requestAnimationFrame(u)};return c.addEventListener("scroll",g),setTimeout(()=>{u()},500),()=>{c.removeEventListener("scroll",g)}};return M(()=>{if(l.value){const c=()=>{T(),u()};b=new ResizeObserver(c),b.observe(l.value)}const o=C();W(()=>{o&&o()})}),W(()=>{b&&b.disconnect()}),{item:r,viewRef:l,modulePadding:e,imageSize:v,fontSize:y,isShowInfo:d,tagContainerRef:_,fileName:x,subEssay:f,subSet:k}}},J={ref:"viewRef",style:{"border-radius":"10px",overflow:"hidden"}},K=["src","width"],Q={class:"dateText"},X={key:0},Y={key:0,class:"tagContainer",ref:"tagContainerRef"},Z={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},$={class:"setTag"},ee={key:0,style:{"padding-left":"3px"}},te={key:1,style:{"padding-left":"3px"}},se={key:0,class:"tagDivider"},ie={class:"tag"},ne={key:1,class:"info"},oe=["src"],ae={class:"title"},re={class:"dateText"},le={key:0},ce={key:0,class:"tagContainer",ref:"tagContainerRef"},de={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},me={class:"setTag"},ge={key:0,style:{"padding-left":"3px"}},fe={key:1,style:{"padding-left":"3px"}},he={key:0,class:"tagDivider"},ve={class:"tag"},_e={key:0,class:"info"},ue=["src"],ye={class:"title"},ke={class:"dateText"},be={key:0},xe={key:0,class:"tagContainer",ref:"tagContainerRef"},pe={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},Ce={class:"setTag"},Se={key:0,style:{"padding-left":"3px"}},we={key:1,style:{"padding-left":"3px"}},Ee={key:0,class:"tagDivider"},Te={class:"tag"},De={key:1,class:"info"},We=["src"],Ie={class:"title"},ze={class:"dateText"},Me={key:0},Ae={key:0,class:"tagContainer",ref:"tagContainerRef"},Re={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},Ne={class:"setTag"},Fe={key:0,style:{"padding-left":"3px"}},Le={key:1,style:{"padding-left":"3px"}},Oe={key:0,class:"tagDivider"},Ve={class:"tag"},He={key:1,class:"info"};function qe(m,r,l,e,v,y){return t(),s("div",J,[e.item.view==="module"?(t(),s("div",{key:0,class:S(e.item.view),style:D(`padding: ${e.modulePadding}px;`)},[n("div",null,[e.item.image?(t(),s("img",{key:0,src:`./image/${e.item.image}`,width:e.imageSize},null,8,K)):i("",!0),n("div",null,[n("p",{class:"title",style:D(`font-size: ${e.fontSize}px;`)},a(e.fileName),5),n("div",Q,[n("span",null,a(e.item.createDate),1),e.item.updateDate?(t(),s("span",X," 至 "+a(e.item.updateDate),1)):i("",!0)])])]),e.item.sub||e.item.tag?(t(),s("div",Y,[e.item.sub?(t(),s("div",Z,[n("div",$,[r[0]||(r[0]=n("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),s("span",ee,"文章"+a(e.subEssay),1)):i("",!0),e.subSet>0?(t(),s("span",te,"合集"+a(e.subSet),1)):i("",!0)]),e.item.tag?(t(),s("div",se)):i("",!0)])):i("",!0),e.item.tag?(t(!0),s(w,{key:1},E(e.item.tag,d=>(t(),s("div",{key:d},[n("div",ie,a(d),1)]))),128)):i("",!0)],512)):i("",!0),e.isShowInfo&&e.item.info?(t(),s("p",ne,a(e.item.info),1)):i("",!0)],6)):i("",!0),e.item.view==="set"?(t(),s("div",{key:1,class:S(e.item.view)},[n("div",null,[e.item.image?(t(),s("img",{key:0,src:`./image/${e.item.image}`},null,8,oe)):i("",!0),n("div",{style:D(e.item.image?"width: calc(100% - 80px);":"width: 100%;")},[n("p",ae,a(e.fileName),1),n("div",re,[n("span",null,a(e.item.createDate),1),e.item.updateDate?(t(),s("span",le," 至 "+a(e.item.updateDate),1)):i("",!0)]),e.item.sub||e.item.tag?(t(),s("div",ce,[e.item.sub?(t(),s("div",de,[n("div",me,[r[1]||(r[1]=n("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),s("span",ge,"文章"+a(e.subEssay),1)):i("",!0),e.subSet>0?(t(),s("span",fe,"合集"+a(e.subSet),1)):i("",!0)]),e.item.tag?(t(),s("div",he)):i("",!0)])):i("",!0),e.item.tag?(t(!0),s(w,{key:1},E(e.item.tag,d=>(t(),s("div",{key:d},[n("div",ve,a(d),1)]))),128)):i("",!0)],512)):i("",!0)],4)]),e.item.info?(t(),s("p",_e,a(e.item.info),1)):i("",!0)],2)):i("",!0),e.item.view==="cover"?(t(),s("div",{key:2,class:S(e.item.view)},[e.item.image?(t(),s("img",{key:0,src:`./image/${e.item.image}`},null,8,ue)):i("",!0),n("div",null,[n("p",ye,a(e.fileName),1),n("div",ke,[n("span",null,a(e.item.createDate),1),e.item.updateDate?(t(),s("span",be," 至 "+a(e.item.updateDate),1)):i("",!0)]),e.item.sub||e.item.tag?(t(),s("div",xe,[e.item.sub?(t(),s("div",pe,[n("div",Ce,[r[2]||(r[2]=n("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),s("span",Se,"文章"+a(e.subEssay),1)):i("",!0),e.subSet>0?(t(),s("span",we,"合集"+a(e.subSet),1)):i("",!0)]),e.item.tag?(t(),s("div",Ee)):i("",!0)])):i("",!0),e.item.tag?(t(!0),s(w,{key:1},E(e.item.tag,d=>(t(),s("div",{key:d},[n("div",Te,a(d),1)]))),128)):i("",!0)],512)):i("",!0),e.isShowInfo&&e.item.info?(t(),s("p",De,a(e.item.info),1)):i("",!0)])],2)):i("",!0),e.item.view==="essay"?(t(),s("div",{key:3,class:S(e.item.view)},[n("div",null,[e.item.image?(t(),s("img",{key:0,src:`./image/${e.item.image}`},null,8,We)):i("",!0),n("div",null,[n("p",Ie,a(e.fileName),1),n("div",ze,[n("span",null,a(e.item.createDate),1),e.item.updateDate?(t(),s("span",Me," 至 "+a(e.item.updateDate),1)):i("",!0)])])]),e.item.sub||e.item.tag?(t(),s("div",Ae,[e.item.sub?(t(),s("div",Re,[n("div",Ne,[r[3]||(r[3]=n("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),s("span",Fe,"文章"+a(e.subEssay),1)):i("",!0),e.subSet>0?(t(),s("span",Le,"合集"+a(e.subSet),1)):i("",!0)]),e.item.tag?(t(),s("div",Oe)):i("",!0)])):i("",!0),e.item.tag?(t(!0),s(w,{key:1},E(e.item.tag,d=>(t(),s("div",{key:d},[n("div",Ve,a(d),1)]))),128)):i("",!0)],512)):i("",!0),e.item.info?(t(),s("p",He,a(e.item.info),1)):i("",!0)],2)):i("",!0)],512)}const Ue=I(U,[["render",qe],["__scopeId","data-v-5180c27e"]]);export{Ue as C,Ge as S,Pe as W};
