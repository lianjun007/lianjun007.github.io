import{r as g,i as A,o as z,p as W,b as t,c as a,g as E,_ as R,a as D,d as F,m as S,e as r,h as s,t as o,F as C,j as T}from"./index-C4FbMClA.js";import{a as M,g as H}from"./function-aY7JZtoC.js";const q=["innerHTML"],Be={__name:"SvgIcon",props:{src:{type:String,required:!0},color:{type:String,default:"var(--themeColor)"},size:{type:Array,default:()=>[18,18]}},setup(h){const i=h,l=g(""),e=A(()=>({width:`${i.size[0]}px`,height:`${i.size[1]}px`})),_=async()=>{try{const c=await fetch(i.src);if(!c.ok)throw new Error(`SVG加载失败: ${c.statusText}`);const v=await c.text();l.value=v,m()}catch(c){console.error("SVG加载错误:",c),l.value="<svg><text x='10' y='20'>SVG Error</text></svg>"}},m=()=>{if(!l.value)return;const x=new DOMParser().parseFromString(l.value,"image/svg+xml").querySelector("svg");x&&(x.querySelectorAll("[fill]").forEach(f=>f.setAttribute("fill",i.color)),x.querySelectorAll("[stroke]").forEach(f=>f.setAttribute("stroke",i.color)),l.value=x.outerHTML)};return z(_),W(()=>i.src,_),W(()=>i.color,m),(c,v)=>(t(),a("div",{innerHTML:l.value,class:"svgIcon",style:E(e.value)},null,12,q))}},j={name:"Waterfall",props:{columnCount:{type:Number,default:2}},setup(h){const i=g(null);let l=null,e=null,_=0;const m=()=>{const f=i.value;if(!f)return;const b=Array.from(f.children),k=f.offsetWidth,y=k<240?1:Math.min(Math.floor(k/220),h.columnCount),I=new Array(y).fill(0),w=(k-(y-1)*10)/y;b.forEach(n=>{const d=n.offsetHeight,u=I.indexOf(Math.min(...I));n.style.width=`${w}px`,n.style.top=`${I[u]+10}px`,n.style.left=`${u*w+u*10}px`,I[u]+=d+10}),f.style.height=`${Math.max(...I)}px`},c=()=>{e=setInterval(()=>{m()},300)},v=()=>{e&&(clearInterval(e),e=null)},x=()=>{const f=i.value;if(!f)return;const b=f.offsetWidth;b!==_&&(m(),_=b)};return z(()=>{l=new ResizeObserver(x),i.value&&l.observe(i.value),c()}),D(()=>{l&&l.disconnect(),v()}),{waterfallContainer:i}}},B={id:"waterfall",class:"cardModule",ref:"waterfallContainer"};function G(h,i,l,e,_,m){return t(),a("div",B,[F(h.$slots,"default",{},void 0)],512)}const Ge=R(j,[["render",G],["__scopeId","data-v-55840f9c"]]),P={name:"CardView",props:{item:{type:Object,required:!0}},computed:{filteredTags(){return this.cardItem.tag?this.cardItem.tag:[]}},setup(h){const i=g(h.item),l=g(null),e=g(0),_=g(0),m=g(0),c=g(!0);let v;const x=()=>{if(l.value){const n=l.value.getBoundingClientRect().width;e.value=Math.min(n/7>30?n/7:20,70),_.value=Math.min(n/3,120),m.value=Math.min(n/13>20?n/13:20,30);const d=300;c.value=n>=d}},f=g(0),b=g(0);i.value.sub&&i.value.sub.forEach(n=>{n.sub?b.value++:f.value++}),fetch("./json/tagTheme.json").then(n=>n.json()).then(n=>{Array.from(document.getElementsByClassName("tag")).forEach(d=>{const u=d.textContent.trim(),p=getComputedStyle(d).getPropertyValue("--subThemeColor");n[u]?(d.style.backgroundColor=n[u],d.style.color=M(n[u])):(d.style.backgroundColor=p,d.style.color=M(p))})});const k=A(()=>H(h.item.path)),y=g(null),I=()=>{if(!y.value)return;const n=y.value,d=n.scrollLeft,u=n.scrollWidth-n.clientWidth,p=20,N=d<=0,L=d>=u,O=N?0:p,V=L?100:100-p;n.style.mask=`
            linear-gradient(
                90deg,
                transparent 0,
                #fff ${O}%,
                #fff ${V}%,
                transparent 100%
            )
            `},w=()=>{if(!y.value)return;let n;const d=y.value,u=()=>{window.cancelAnimationFrame(n),n=window.requestAnimationFrame(I)};return d.addEventListener("scroll",u),setTimeout(()=>{I()},500),()=>{d.removeEventListener("scroll",u)}};return z(()=>{if(l.value){const d=()=>{x(),I()};v=new ResizeObserver(d),v.observe(l.value)}const n=w();D(()=>{n&&n()})}),D(()=>{v&&v.disconnect()}),{cardItem:i,viewRef:l,modulePadding:e,imageSize:_,fontSize:m,isShowInfo:c,tagContainerRef:y,fileName:k,subEssay:f,subSet:b}}},U={ref:"viewRef",style:{"border-radius":"10px",overflow:"hidden"}},J=["src","width"],K={class:"dateText"},Q={key:0},X={key:0,class:"tagContainer",ref:"tagContainerRef"},Y={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},Z={class:"setTag"},$={key:0,style:{"padding-left":"3px"}},ee={key:1,style:{"padding-left":"3px"}},te={key:0,class:"tagDivider"},ae={class:"tag"},se={key:1,class:"info"},re=["src"],ne={class:"title"},oe={class:"dateText"},ie={key:0},ce={key:0,class:"tagContainer",ref:"tagContainerRef"},le={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},de={class:"setTag"},me={key:0,style:{"padding-left":"3px"}},fe={key:1,style:{"padding-left":"3px"}},ue={key:0,class:"tagDivider"},ge={class:"tag"},_e={key:0,class:"info"},ve=["src"],he={class:"title"},ye={class:"dateText"},Ie={key:0},xe={key:0,class:"tagContainer",ref:"tagContainerRef"},be={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},ke={class:"setTag"},pe={key:0,style:{"padding-left":"3px"}},we={key:1,style:{"padding-left":"3px"}},Se={key:0,class:"tagDivider"},Ce={class:"tag"},Te={key:1,class:"info"},Ee=["src"],De={class:"title"},ze={class:"dateText"},We={key:0},Me={key:0,class:"tagContainer",ref:"tagContainerRef"},Ae={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},Re={class:"setTag"},Ne={key:0,style:{"padding-left":"3px"}},Le={key:1,style:{"padding-left":"3px"}},Oe={key:0,class:"tagDivider"},Ve={class:"tag"},Fe={key:1,class:"info"};function He(h,i,l,e,_,m){return t(),a("div",U,[e.cardItem.view==="module"?(t(),a("div",{key:0,class:S(e.cardItem.view),style:E(`padding: ${e.modulePadding}px;`)},[r("div",null,[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`,width:e.imageSize},null,8,J)):s("",!0),r("div",null,[r("p",{class:"title",style:E(`font-size: ${e.fontSize}px;`)},o(e.fileName),5),r("div",K,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",Q," 至 "+o(e.cardItem.updateDate),1)):s("",!0)])])]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",X,[e.cardItem.sub?(t(),a("div",Y,[r("div",Z,[i[0]||(i[0]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",$,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",ee,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",te)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(m.filteredTags,c=>(t(),a("div",{key:c},[r("div",ae,o(c),1)]))),128))],512)):s("",!0),e.isShowInfo&&e.cardItem.info?(t(),a("p",se,o(e.cardItem.info),1)):s("",!0)],6)):s("",!0),e.cardItem.view==="set"?(t(),a("div",{key:1,class:S(e.cardItem.view)},[r("div",null,[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`},null,8,re)):s("",!0),r("div",{style:E(e.cardItem.image?"width: calc(100% - 80px);":"width: 100%;")},[r("p",ne,o(e.fileName),1),r("div",oe,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",ie," 至 "+o(e.cardItem.updateDate),1)):s("",!0)]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",ce,[e.cardItem.sub?(t(),a("div",le,[r("div",de,[i[1]||(i[1]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",me,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",fe,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",ue)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(m.filteredTags,c=>(t(),a("div",{key:c},[r("div",ge,o(c),1)]))),128))],512)):s("",!0)],4)]),e.cardItem.info?(t(),a("p",_e,o(e.cardItem.info),1)):s("",!0)],2)):s("",!0),e.cardItem.view==="cover"?(t(),a("div",{key:2,class:S(e.cardItem.view)},[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`},null,8,ve)):s("",!0),r("div",null,[r("p",he,o(e.fileName),1),r("div",ye,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",Ie," 至 "+o(e.cardItem.updateDate),1)):s("",!0)]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",xe,[e.cardItem.sub?(t(),a("div",be,[r("div",ke,[i[2]||(i[2]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",pe,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",we,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",Se)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(m.filteredTags,c=>(t(),a("div",{key:c},[r("div",Ce,o(c),1)]))),128))],512)):s("",!0),e.isShowInfo&&e.cardItem.info?(t(),a("p",Te,o(e.cardItem.info),1)):s("",!0)])],2)):s("",!0),e.cardItem.view==="essay"?(t(),a("div",{key:3,class:S(e.cardItem.view)},[r("div",null,[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`},null,8,Ee)):s("",!0),r("div",null,[r("p",De,o(e.fileName),1),r("div",ze,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",We," 至 "+o(e.cardItem.updateDate),1)):s("",!0)])])]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",Me,[e.cardItem.sub?(t(),a("div",Ae,[r("div",Re,[i[3]||(i[3]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",Ne,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",Le,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",Oe)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(m.filteredTags,c=>(t(),a("div",{key:c},[r("div",Ve,o(c),1)]))),128))],512)):s("",!0),e.cardItem.info?(t(),a("p",Fe,o(e.cardItem.info),1)):s("",!0)],2)):s("",!0)],512)}const Pe=R(P,[["render",He],["__scopeId","data-v-122d6d1b"]]);export{Pe as C,Ge as W,Be as _};
