import{c as A,r as g,o as z,w as O,b as t,d as a,n as E,_ as M,a as D,e as H,p as S,f as r,i as s,t as o,F as C,k as T}from"./index-C8mH0GvV.js";import{a as W,g as q}from"./function-aY7JZtoC.js";const V=["innerHTML"],je={__name:"SvgIcon",props:{src:{type:String,required:!0},color:{type:String,default:"var(--themeColor)"},size:{type:[Number,Array],default:18},rotate:{type:Number,default:0}},setup(v){const d=v,l=A(()=>{const n=d.size;return typeof n=="number"?{width:`${n}px`,height:`${n}px`}:Array.isArray(n)?{width:`${n[0]}px`,height:`${n[1]}px`}:n}),e=g("");async function _(){const n=await fetch(d.src);if(!n.ok)throw new Error(`SVG加载失败: ${n.statusText}`);const h=await n.text();e.value=h,f()}function f(){if(!e.value)return;const b=new DOMParser().parseFromString(e.value,"image/svg+xml").querySelector("svg");b&&(b.querySelectorAll("[fill]").forEach(m=>m.setAttribute("fill",d.color)),b.querySelectorAll("[stroke]").forEach(m=>m.setAttribute("stroke",d.color))),e.value=b.outerHTML}return z(()=>{_()}),O(d,_),(n,h)=>(t(),a("div",{innerHTML:e.value,class:"svgIcon",style:E([l.value,{transform:`rotate(${d.rotate}deg)`}])},null,12,V))}},B={name:"Waterfall",props:{columnCount:{type:Number,default:2}},setup(v){const d=g(null);let l=null,e=null,_=0;const f=()=>{const m=d.value;if(!m)return;const p=Array.from(m.children),x=m.offsetWidth,y=x<240?1:Math.min(Math.floor(x/220),v.columnCount),I=new Array(y).fill(0),w=(x-(y-1)*10)/y;p.forEach(i=>{const c=i.offsetHeight,u=I.indexOf(Math.min(...I));i.style.width=`${w}px`,i.style.top=`${I[u]+10}px`,i.style.left=`${u*w+u*10}px`,I[u]+=c+10}),m.style.height=`${Math.max(...I)}px`},n=()=>{e=setInterval(()=>{f()},300)},h=()=>{e&&(clearInterval(e),e=null)},b=()=>{const m=d.value;if(!m)return;const p=m.offsetWidth;p!==_&&(f(),_=p)};return z(()=>{l=new ResizeObserver(b),d.value&&l.observe(d.value),n()}),D(()=>{l&&l.disconnect(),h()}),{waterfallContainer:d}}},j={id:"waterfall",class:"cardModule",ref:"waterfallContainer"};function P(v,d,l,e,_,f){return t(),a("div",j,[H(v.$slots,"default",{},void 0)],512)}const Pe=M(B,[["render",P],["__scopeId","data-v-55840f9c"]]),G={name:"CardView",props:{item:{type:Object,required:!0}},computed:{filteredTags(){return this.cardItem.tag?this.cardItem.tag:[]}},setup(v){const d=g(v.item),l=g(null),e=g(0),_=g(0),f=g(0),n=g(!0);let h;const b=()=>{if(l.value){const i=l.value.getBoundingClientRect().width;e.value=Math.min(i/7>30?i/7:20,70),_.value=Math.min(i/3,120),f.value=Math.min(i/13>20?i/13:20,30);const c=300;n.value=i>=c}},m=g(0),p=g(0);d.value.sub&&d.value.sub.forEach(i=>{i.sub?p.value++:m.value++}),fetch("./json/tagTheme.json").then(i=>i.json()).then(i=>{Array.from(document.getElementsByClassName("tag")).forEach(c=>{const u=c.textContent.trim(),k=getComputedStyle(c).getPropertyValue("--subThemeColor");i[u]?(c.style.backgroundColor=i[u],c.style.color=W(i[u])):(c.style.backgroundColor=k,c.style.color=W(k))})});const x=A(()=>q(v.item.path)),y=g(null),I=()=>{if(!y.value)return;const i=y.value,c=i.scrollLeft,u=i.scrollWidth-i.clientWidth,k=20,N=c<=0,R=c>=u,F=N?0:k,L=R?100:100-k;i.style.mask=`
            linear-gradient(
                90deg,
                transparent 0,
                #fff ${F}%,
                #fff ${L}%,
                transparent 100%
            )
            `},w=()=>{if(!y.value)return;let i;const c=y.value,u=()=>{window.cancelAnimationFrame(i),i=window.requestAnimationFrame(I)};return c.addEventListener("scroll",u),setTimeout(()=>{I()},500),()=>{c.removeEventListener("scroll",u)}};return z(()=>{if(l.value){const c=()=>{b(),I()};h=new ResizeObserver(c),h.observe(l.value)}const i=w();D(()=>{i&&i()})}),D(()=>{h&&h.disconnect()}),{cardItem:d,viewRef:l,modulePadding:e,imageSize:_,fontSize:f,isShowInfo:n,tagContainerRef:y,fileName:x,subEssay:m,subSet:p}}},U={ref:"viewRef",style:{"border-radius":"10px",overflow:"hidden"}},J=["src","width"],K={class:"dateText"},Q={key:0},X={key:0,class:"tagContainer",ref:"tagContainerRef"},Y={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},Z={class:"setTag"},$={key:0,style:{"padding-left":"3px"}},ee={key:1,style:{"padding-left":"3px"}},te={key:0,class:"tagDivider"},ae={class:"tag"},se={key:1,class:"info"},re=["src"],ne={class:"title"},ie={class:"dateText"},oe={key:0},de={key:0,class:"tagContainer",ref:"tagContainerRef"},ce={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},le={class:"setTag"},me={key:0,style:{"padding-left":"3px"}},fe={key:1,style:{"padding-left":"3px"}},ue={key:0,class:"tagDivider"},ge={class:"tag"},_e={key:0,class:"info"},he=["src"],ve={class:"title"},ye={class:"dateText"},Ie={key:0},be={key:0,class:"tagContainer",ref:"tagContainerRef"},pe={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},xe={class:"setTag"},ke={key:0,style:{"padding-left":"3px"}},we={key:1,style:{"padding-left":"3px"}},Se={key:0,class:"tagDivider"},Ce={class:"tag"},Te={key:1,class:"info"},Ee=["src"],De={class:"title"},ze={class:"dateText"},We={key:0},Ae={key:0,class:"tagContainer",ref:"tagContainerRef"},Me={key:0,style:{display:"flex","align-items":"center",gap:"5px"}},Ne={class:"setTag"},Re={key:0,style:{"padding-left":"3px"}},Fe={key:1,style:{"padding-left":"3px"}},Le={key:0,class:"tagDivider"},Oe={class:"tag"},He={key:1,class:"info"};function qe(v,d,l,e,_,f){return t(),a("div",U,[e.cardItem.view==="module"?(t(),a("div",{key:0,class:S(e.cardItem.view),style:E(`padding: ${e.modulePadding}px;`)},[r("div",null,[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`,width:e.imageSize},null,8,J)):s("",!0),r("div",null,[r("p",{class:"title",style:E(`font-size: ${e.fontSize}px;`)},o(e.fileName),5),r("div",K,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",Q," 至 "+o(e.cardItem.updateDate),1)):s("",!0)])])]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",X,[e.cardItem.sub?(t(),a("div",Y,[r("div",Z,[d[0]||(d[0]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",$,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",ee,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",te)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(f.filteredTags,n=>(t(),a("div",{key:n},[r("div",ae,o(n),1)]))),128))],512)):s("",!0),e.isShowInfo&&e.cardItem.info?(t(),a("p",se,o(e.cardItem.info),1)):s("",!0)],6)):s("",!0),e.cardItem.view==="set"?(t(),a("div",{key:1,class:S(e.cardItem.view)},[r("div",null,[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`},null,8,re)):s("",!0),r("div",{style:E(e.cardItem.image?"width: calc(100% - 80px);":"width: 100%;")},[r("p",ne,o(e.fileName),1),r("div",ie,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",oe," 至 "+o(e.cardItem.updateDate),1)):s("",!0)]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",de,[e.cardItem.sub?(t(),a("div",ce,[r("div",le,[d[1]||(d[1]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",me,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",fe,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",ue)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(f.filteredTags,n=>(t(),a("div",{key:n},[r("div",ge,o(n),1)]))),128))],512)):s("",!0)],4)]),e.cardItem.info?(t(),a("p",_e,o(e.cardItem.info),1)):s("",!0)],2)):s("",!0),e.cardItem.view==="cover"?(t(),a("div",{key:2,class:S(e.cardItem.view)},[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`},null,8,he)):s("",!0),r("div",null,[r("p",ve,o(e.fileName),1),r("div",ye,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",Ie," 至 "+o(e.cardItem.updateDate),1)):s("",!0)]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",be,[e.cardItem.sub?(t(),a("div",pe,[r("div",xe,[d[2]||(d[2]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",ke,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",we,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",Se)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(f.filteredTags,n=>(t(),a("div",{key:n},[r("div",Ce,o(n),1)]))),128))],512)):s("",!0),e.isShowInfo&&e.cardItem.info?(t(),a("p",Te,o(e.cardItem.info),1)):s("",!0)])],2)):s("",!0),e.cardItem.view==="essay"?(t(),a("div",{key:3,class:S(e.cardItem.view)},[r("div",null,[e.cardItem.image?(t(),a("img",{key:0,src:`./image/${e.cardItem.image}`},null,8,Ee)):s("",!0),r("div",null,[r("p",De,o(e.fileName),1),r("div",ze,[r("span",null,o(e.cardItem.createDate),1),e.cardItem.updateDate?(t(),a("span",We," 至 "+o(e.cardItem.updateDate),1)):s("",!0)])])]),e.cardItem.sub||e.cardItem.tag?(t(),a("div",Ae,[e.cardItem.sub?(t(),a("div",Me,[r("div",Ne,[d[3]||(d[3]=r("span",{style:{"border-right":"1px solid black","padding-right":"3px"}},"合集",-1)),e.subEssay>0?(t(),a("span",Re,"文章"+o(e.subEssay),1)):s("",!0),e.subSet>0?(t(),a("span",Fe,"合集"+o(e.subSet),1)):s("",!0)]),e.cardItem.tag?(t(),a("div",Le)):s("",!0)])):s("",!0),(t(!0),a(C,null,T(f.filteredTags,n=>(t(),a("div",{key:n},[r("div",Oe,o(n),1)]))),128))],512)):s("",!0),e.cardItem.info?(t(),a("p",He,o(e.cardItem.info),1)):s("",!0)],2)):s("",!0)],512)}const Ge=M(G,[["render",qe],["__scopeId","data-v-122d6d1b"]]);export{Ge as C,Pe as W,je as _};
